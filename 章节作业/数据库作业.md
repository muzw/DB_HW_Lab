# 数据库基础作业
---

### 学号：PB20051061	姓名：牟真伟
---
## 第一章 序论

### 1.简述数据、数据库、数据库管理系统、数据库系统的含义及其联系？ 

​	数据：信息的符号记录，是数据库处理和研究的对象

​	数据库：长期存储在计算机内，有组织的，可共享的相关数据的集合

​	数据库管理系统：位于用户和操作系统之间的一层数据管理软件

​	数据库系统：计算机硬件为基础的记录保持系统。包括数据库，数据库管理系统，应用系统，管理员和用户，计算机硬件等。

### 2.信息模型与数据模型的有何区别，试述数据模型的三要素。

​	信息模型是面向信息世界的，用来描述现实世界中的信息结构。

​	数据模型是面向数据库的，是按照计算机系统的观点对数据建模。

​	数据模型的三要素：数据结构，数据操作，数据的约束条件

### 3.简述数据库 SPARC 模式结构的内容。

​	数据库分为三级模式，外模式，模式，内模式。外模式通过**外模式/模式映像**调用模式，模式通过**模式/内模式映像**调用内模式。

​	修改了表结构(即模式)，只需要修改外模式和模式之间的映像,而不需要修改用户程序.从而实现**逻辑独立性**。

​	修改了数据的物理存储方式,只需要修改模式和内模式之间的映像，而表结构(即模式)能保持不变，从而实现**物理独立性**。

### 4.什么是数据独立性？数据独立性包含哪两种？

​	数据独立性指应用程序和数据之间的依赖程度，相互影响。

​	数据独立性包括物理独立性和逻辑独立性。

### 5.关系模型相对于层次和网状模型来说有哪些优缺点？
优点：

- 关系模型概念单一。无论是实体还是实体之间的联系都用关系来表示。对数据的检索和更新结果也是基于关系（表）的。所以，数据结构简单清晰，用户易懂	易用。
- 关系模型的存取路径对用户透明，从而具有较高的数据独立性，更好的安全保密性，也简化了程序员的工作和数据库开发建立的工作。

缺点：

- 由于存取路径对用户是透明的，查询效率不高
- 为了提高系统性能，数据库管理系统必须对用户的查询请求进行优化


### 6.有一个记录球队、球员和球迷信息的数据库，包括： 
#### 1） 球队：球队编号、名称、球员、队长（队员之一）、队服颜色； 
#### 2） 球员：球员编号、姓名、年龄、籍贯、所属球队； 
#### 3） 球迷：姓名、年龄、喜爱的球队、喜爱的球员、喜爱的颜色。 
### 用 E-R 图画出该数据库的信息模型。

![image-20221027190318418](https://gitee.com/aweary/img/raw/master/img/image-20221027190318418.png)


## 第二章 关系数据库 

----

### 1. 比较以下概念的区别： 
   1） 关系与关系模式 
   2） 笛卡尔积与连接 
   3） 等值连接与自然连接 
   4） 自然连接与外连接

### 2.

![image-20221008180141061](https://gitee.com/aweary/img/raw/master/img/image-20221008180141061.png)

### 3. 
![image-20221010001131262](https://gitee.com/aweary/img/raw/master/img/image-20221010001131262.png)

### 4.

![image-20221010001621576](https://gitee.com/aweary/img/raw/master/img/image-20221010001621576.png)

## 第三章 关系数据库标准查询语言 SQL 

#### 1.简述 SQL 语言的特点。

- 简洁统一：集DDL,DML，DCL于一体，语言风格统一，关键字少

- 面向集合操作

- 高度非过程化

- 用统一的语法结构提供自含式或嵌入式的使用方法

#### 2.  简述视图的作用

- 简化用户操作
- 多角度看待同一数据
- 实现逻辑独立性
- 对数据提供安全保护

####  3. 已知学生表 student、课程表 course 和学生选课表 s_c 的关系模式如下： student（sno，sname，sex，age,dept,place） 即（学号、姓名、性别、年龄,所属院系，籍贯）, course（cno，cname，credit，pcno） 即（课程号、课程名，学分，预修课程号）, s_c（sno，cno，grade） 即（学号、课程号、成绩）, 
#### 1） 查询考试成绩不及格的学生的学号及成绩；

``` sql
select sno,grade from s_c where grade < 60;
```

#### 2） 查询年龄在 19~25 岁（包含）之间的学生的姓名、院系和年龄，并按年龄降序排列； 

``` sql
select sname,dept,age from student where age between 19 and 25 order by age desc;
```

#### 3） 查询姓名中含有“浩”字的学生信息； 

``` sql
select * from student where sname like '%浩%';
```

#### 4） 按院系查询学生总人数； 

``` sql
select dept,counter(*) from student group by dept;
```

#### 5） 计算选修了 008 号课程的学生的平均成绩、最高分及最低分； 

``` sql
select AVG(grade),MAX(grade),MIN(grade) from s_c where cno = '008';
```

#### 6） 求平均成绩在 85 分以上（含）的各门课程及平均成绩。

``` sql
select cno,AVG(grade) from s_c group by cno having AVG(grade);
```

#### 4.  已知学生表 S、课程表 C 和学生选课表 SC 的关系模式如下： S（Sno，Sname，Sex，age），即（学号、姓名、性别、年龄） C（Cno，Cname，Teacher），即（课程号、课程名，教师） SC（Sno，Cno，Grade），即（学号、课程号、成绩） 试用 SQL 语句实现下列查询： 

#### 1） 查询“张琳”老师所授课程号和课程名； 

``` sql
select Cno,Cname from C where Teacher = '张琳';
```

#### 2） 查询选修课程名为“C语言”或者“数据库”的学生学号； 

``` sql
select Sno from SC natural join C where Cname in ('C语言','数据库');
```

#### 3） 查询“陈浩”同学所选修课程的课程号及课程名； 

``` sql
select Cno,Cname from SC natural join C natural join S where Sname = '陈浩';
```

#### 4） 查询至少选修课程号为 C1 和 C2 的学生姓名； 

``` sql
select Sname from S, SC SC1, SC SC2 where SC1.Sno=SC2.Sno and S.no = SC1.Sno and SC1.Cno = 'C1' and SC2.Cno = 'C2';
```

#### 5） 用 EXISTS 查询学习课程号为 C5 的学生姓名和年龄； 

```

```

#### 6） 查询不选修 C3 课程的学生姓名和性别。



#### 5.  设有以下关系: 职工：E(职工号，姓名，性别，职务，家庭住址，部门号) 部门：D(部门号，部门名称，地址，电话) 保健：B(保健号，职工号，检查日期，健康状况) 用关系代数（1-4 题），SQL 语言完成全部功能： 
#### 1）查询所有女科长的姓名和家庭地址；



#### 2）查询部门名称为‘办公室’的科长姓名和家庭地址；



#### 3）查询部门名称为‘财务科’、健康状况为‘良好’的职工姓名和家庭住址； 



#### 4）删除职工关系中职工号为‘1006’的记录； 



#### 5）将职工号为 1006 的职工健康状况改为‘一般’；



#### 6）建立健康状况为‘差’的职工情况的视图。



#### 6.简述嵌入式SQL中，主语言和SQL语言之间有哪几种通信方式。



## 第四章 关系数据库设计理论

#### 1.设关系模式R(ABCD),F是R上成立的函数依赖集，F={A→C,C→B}，相对于F写出关系模式R的主关键字。
​	主关键字为（A,D）

#### 2.设关系模式R（ABC），F是R上成立的函数依赖，F={B→C，C→A}，那么 ρ={AB，AC}相对于F是否保持无损分解和函数依赖？说明理由。
​	不能保持无损分解，分解后的两个关系做自然连接时，对每个A,B属性和C属性要做笛卡尔积，可能会比原关系中B属性和C属性的组合多,导致丢失信息。

​	不能保持函数依赖，分解后，只有B->A和C->A的函数依赖，无法还原成分解前的B->C->A的依赖关系。

#### 3.关系模式 R（ABCD），F是R上成立的函数依赖，F={AB→CD，A→D}。

##### 1）试说明 R 不是 2NF 模式的理由；

##### 2）试把 R 分解成 2NF 模式集。

​	1）因为A->D是完全函数依赖，所以主属性AB对D是部分函数依赖，不符合2NF定义

​	2）分解为{ABC,AD}

#### 4.设关系模式 R（ABC），F 是 R 上成立的函数依赖，F={C→B，B→A}

##### 1）试说明 R 不是 3NF 模式集；

##### 2）试把 R 分解为 3NF 模式集。

​	1)主属性为C,A对主属性C是部分函数依赖，不符合3NF定义

​	2）分解为{CB,BA}

#### 5.设有关系模式 R（职工名，项目名，工资，部门号，部门经理），如果规定每个职工可以参加多个项目，每个项目都可以各领一份工资；每个项目只属于一个部门管理；每个部门只有一个部门经理。要求：

##### 1）写出关系模式 R 的函数依赖和主键；

##### 2）R 是 2NF 模式吗？若不是请说明理由，并把 R 分解到 2NF 模式集；

##### 3）把 R 分解到 3NF 模式集。

​	1)函数依赖为F={（职工名，项目名）->工资，项目名->部门号，部门号->部门经理}

​	2)由于部门号和部门经理部分依赖于主键（职工名，项目名），所以R不是2NF.

​		可将R分解为R1(职工名，项目名，工资)和R2(项目名，部门号，部门经理),R1,R2均是2NF

​	3)部门经理传递依赖于项目名，

​		可将R分解为R1(职工名，项目名，工资)和R2(项目名，部门号)和R3(部门号，部门经理)，R1,R2,R3均是3NF

#### 6.现需要建立一个关于学生、班级、系和社团等信息的一个关系数据库系统，一个系有若干专业，每个专业每年只招一个班，每个班有若干名学生，一个系的学生住在同一宿舍区，每个学生可以参加若干个社团，每个社团有若干名学生。需要考虑记录以下信息：
##### 学生属性有：学号、姓名、出生年月、系名、班级号、宿舍区；

##### 班级属性有：班级号、专业名、系名、人数、入学年份；

##### 系的属性有：系名、系号、系办公地点、人数； 
##### 社团属性有：社团名、成立年份、地点、人数、学生参加社团的年份。 
##### 请写出你设计的关系模式，指出每个关系模式的候选健、外键，写出每个关系模式的函数依赖集。
​	R1(学号，姓名，出生年月，班级号)

候选键：学号 外键：班级号  函数依赖{学号->（姓名，出生年月，班级号）}

​	R2(系号，系名，系办公地点，人数，宿舍区)

候选键：系号 外键：无  函数依赖{系号->（系名，系办公地点，人数，宿舍区）}

​	R3(班级号，专业名，人数，入学年份)

候选键：班级号 外键：专业名  函数依赖{班级号->（专业名，人数，入学年份）}

​	R4(专业名，系名)

候选键：专业名 外键：系名  函数依赖{专业名->系名}

​	R5(社团名，成立年份，地点，人数)

候选键：社团名 外键：无  函数依赖{社团名->（成立年份，地点，人数）}

​	R6(学号，社团名，学生参加社团的年份)

候选键：（学号，社团名） 外键：无  函数依赖{（学号，社团名）->学生参加社团的年份}

## 第五章  数据库的保护

#### 1.简述数据库安全性控制有哪些措施？

- 用户标识和鉴别
- 使用视图
- 数据加密
- 存取权限控制
- 审计

#### 2.简述数据库并发操作会带来哪些问题？ 

- 修改丢失问题
- 污读问题
- 不可重复读问题
- 幻影读问题

#### 3.简述事务的特性。

- 原子性：事务的操作要么全做后提交，要么全部不做。
- 一致性：事务的执行会保持数据库的一致性。
- 隔离性：多个事务并发时，应和这些事务先后单独执行的结果一样。

- 持久性：事务一旦完成提交，其对数据库的更新将永久反映在数据库中。

#### 4.简述数据库故障的几种类型及相应恢复方法。

- 事务故障
  - 反向扫描日志文件，查找该事务的更新操作
  - 对该事务的更新操作执行逆操作（UNDO）
- 系统故障
  - 反向扫描日志文件，查找未做完的事务的更新操作
  - 对该事务的更新操作执行逆操作（UNDO）
  - 正向扫描日志文件，对重做队列中的事务进行重做（REDO）
- 介质故障
  - 装入最新的数据库副本
  - 装入相关的日志文件，重做相关事务

#### 5.已知两个关系模式： 职工(职工号，姓名，年龄，职务，工资，部门号) 部门(部门号，名称，经理名，电话) 用 SQL 语言定义这两个关系模式，并实现以下完整性约束条件： 
1） 定义每个关系模式的主键； 
2） 定义关系中的参照完整性； 
3） 定义每个职工的年龄不能超过 60 岁。

``` sql
CREATE TABLE 职工(
       	职工号     CHAR(9),
        姓名 		CHAR(20),     
        年龄  		INT CONSTRAINT chk1 CHECK (年龄 between 0 and 60),
        职务		CHAR(20),
        工资  	CHAR(20),
        部门号   	CHAR(20),
    	CONSTRAINT pk_1 PRIMARY KEY (职工号),
    	CONSTRAINT fk_1 FOREIGN KEY (部门号) REFERENCES 部门(部门号)
       );

CREATE TABLE 部门(
    	部门号   	CHAR(9),
        名称 		CHAR(20),    
        经理名 	CHAR(20),
        电话   	CHAR(20),
    	CONSTRAINT pk_2 PRIMARY KEY (部门号)
       );

```


#### 6.已知学生表student、课程表course和学生选课表s_c的关系模式如下:student（sno，sname，sex，age,dept,place） 即（学号、姓名、性别、年龄,所属院系，籍贯）, course（cno，cname，credit，pcno）即（课程号、课程名，学分，预修课程号）, s_c（sno，cno，grade）即（学号、课程号、成绩）, 
试定义以下完整性约束： 
1）  student 中学生年龄在 15~25 之间； 

2）  在 s_c 中插入元组时其 sno 和 cno 必须在关系 student 和 course 中出现； 

3）  删除关系 course 中元组时，首先要把 s_c 中具有同样 cno 的元组删除； 

4）  修改 student 中某个 sno 时，同时修改 s_c 中 sno 的值。

``` sql
CREATE TABLE student(
	sno		CHAR(10),
    sname	 CHAR(20),
    sex		CHAR(5),
    age		INT CONSTRAINT ckhk1 CHECK (age BETWEEN 15 and 25),
    dept	CHAR(10),
    place	CHAR(20)
);

CREATE TABLE course(
	cno		CHAR(10),
    cname	 CHAR(20),
    credit		INT,
    pcno	CHAR(10),
);

CREATE TABLE s_c(
	sno		CHAR(10),
    cno	 	CHAR(10),
    grade		INT,
    CONSTRAINT fk_1 FOREIGN KEY (sno) REFERENCES student(sno),
    CONSTRAINT fk_2 FOREIGN KEY (cno) REFERENCES course(cno),
    CONSTRAINT fk_3 FOREIGN KEY (sno) REFERENCES student(sno) ON DELETE CASCADE,
    CONSTRAINT fk_4 FOREIGN KEY (cno) REFERENCES course(cno) ON UPDATE CASCADE,
);

```


## 第六章  数据库的设计

#### 1.简述数据库设计的基本步骤。





#### 2.要建立一个公司数据库，公司有多个部门，每个部门有多个职员，一个职员仅隶属于一个部门，且一个员工在一个工程中工作，一个工程有多个职员参与，有多个供应商为各个工程供应不同的设备。 
#### 部门属性：部门名，电话 
#### 职员属性：职员号、姓名、性别 
#### 工程属性：工程名、地点 
#### 设备属性：设备号、设备名、产地 
#### 供应商属性：姓名、电话 
#### 请完成以下处理： 
#### 1）  手机满足上述要求的 E-R 图 
#### 2）  将 E-R 图转换为关系模式，用下划线给出其主键。



#### 有运动队和运动会两个方面的实体： 

#### 运动队方面有： 
运动队：队名、教练员名、队员姓名 
队员：队名、队员姓名、性别、项目名 
其中，一个运动队有多个队员，一个队员仅属于一个运动队，一个队仅一个教练。 
运动会方面有： 
运动队：队编号、队名、教练姓名 
项目：项目名、参加运动队的编号、队员姓名、性别、比赛场地。 
其中，一个项目有多个运动队参加，一个运动员可以参加多个项目，一个项目一个比赛场地。 
1）  分别设计运动队和运动会两个局部 E-R 图； 
2）  将它们合并为一个全局 E-R 图(注意合并时的冲突)。